<html>
<head>
  <title>Ajax总结</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.2.9200 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="994"/>
<h1>Ajax总结</h1>

<div>
<span><div><br/></div><div>PHP---一种服务器端脚本语言，可以连接数据库，获取其中的数据</div><div>ajax----不是一种语言，是一种创建交互式网页应用的网页开发技术，依赖js来实现，不需要重载整个页面，只需要重载部分就可以实现数据的更新（表单注册时，防止全部刷新使得页面的信息丢失，普通的表单注册会将页面全部刷新）</div><div><span style="font-size: 15px;"><span style="color: rgb(227, 0, 0);"><b>要实现局部刷新，就必须多次请求，所以在某些场合必须阻止多次请求</b></span></span></div><div>ajax核心---js中的XMLHttpRequest对象，用于在后台与服务器交换数据</div><div><br/></div><div>重点案例：</div><div>表单验证，表格动态获取数据，瀑布流插件封装</div><ul><li>用ajax实现表单验证的思想：</li></ul><div>- 用户填写表达，点击按钮，获得表单中的数据，准备提交</div><div>- 在js中使用XMLHttpRequest对象向服务器端发送请求：                                                                                                                                                                                                                                                        ----设置准备提交的数据，请求的服务器地址-（哪个php文档 ）</div><div>- 服务器端使用PHP对数据进行验证，然后输出验证结果                                                                                                                                                                                                                                                                              ---使用$_POST/$_GET接收上传的表单数据</div><div>- XMLHttpRequest对象接收服务器的验证结果：</div><div>          XMLHttpRequest对象的success方法在请求成功的时候接收从服务器返回的验证数据结果</div><div>          XMLHttpRequest对象的error方法在请求失败时调用，可传入参数得到错误信息：</div><div>           null,timeout,error等</div><ul><li>表格动态获取数据的思想：</li></ul><div>- 点击按钮，即向服务器发起请求</div><div>- 服务器从数据库（xml文件或json文件）读取数据，输出之</div><div>- 请求成功，获取响应主体（从服务器返回的数据），筛选出需要添加到表格中的元素，添加之</div><div>          --&gt;可以选择在php中直接将json字符串解析成对应的对象或数组，然后直接拼接字符串，返回到客户端；</div><div>          --&gt;也可以选择直接从服务器返回JSON字符串，在js中将JSON字符串解析成js对象,然后筛选数据，拼接字符串，添加到表格中</div><div><br/></div><div>XML---一种标记语言，类似html</div><div>JSON(JavaScript Object Notation)</div><div>          ---一种数据交换格式，采用完全独立于语言的文本格式，是ECMAscript的一个子集，借鉴了JS的语法</div><div>          ---任何一种语言都可以识别：</div><div>               js中的解析方法：</div><div>               eval（）//将字符解析成js可以识别的语法</div><div><br/></div><div>      var json = '{&quot;name&quot;: &quot;itcast&quot;, &quot;age&quot;: 10}';</div><div>      var obj =eval('('+json+')');</div><div>              JSON.parse()//将JSON字符串解析成JS对象</div><div>              JSON.stringify()//将JS对象转化为JSON字符串</div><div>               PHP中的解析方法：</div><div>               json_encode()//将PHP数组转换为JSON字符串</div><div>               json_decode(字符串，ture/false)//将JSON字符串转换为对应的数组或对象</div><div><br/></div><div>                    ----&gt;true:转换成数组；false：转换成对象</div><div>                    ----&gt;php中访问对象属性：</div><div><br/></div><div>       $obj=json_decode($json);</div><div>       echo $obj-&gt;name;</div><div><br/></div><div><br/></div><div>xml和json文件的作用：都用来传输数据,储存JSON字符串，便于服务器获取数据</div><div><br/></div><div>Function(),eval(),JSON_parse()区别和联系:</div><div>Function(),eval()都可以将字符串当做一段js代码执行，但是在传进一个JSON形式的字符串时，eval()内必须加括号，不加就会从{开始当做js代码执行，出现语法错误，（）起一个限定的作用，new Function(）内则无需加括号，直接传进字符串即可执行；</div><div>Function()只在当前作用域生效，eval（）写在哪就在哪里生效；</div><div>JSON_parse（）仅仅是把JSON形式的符串直接解析成JSON对象，并非当做js代码执行，不需要加括号</div><div><br/></div><div>     为了实现动态加载数据，前台需要做的一件很重要的事情是：将某一部分需要动态加载的代码以拼接字符串的形式展现出来，然后从后台获取相应的数据，遍历之，从而实现动态加载。有以下几个实现方法：</div><ol><li>   一般方法拼接字符串：</li></ol><div><br/></div><div><br/></div><div>                    var result = xhr.responseText;</div><div>                    result = JSON.parse(result);</div><div>                    console.log(result);</div><div>                    var html = '';</div><div>                    for(var i=0; i&lt;result.length; i++) {</div><div>                        html += '&lt;tr&gt;';</div><div>                        html += '&lt;td&gt;' + result[i].name + '&lt;/td&gt;';</div><div>                        html += '&lt;td&gt;' + result[i].photo + '&lt;/td&gt;';</div><div>                        html += '&lt;td&gt;' + result[i].ablum + '&lt;/td&gt;';</div><div>                        html += '&lt;td&gt;' + result[i].age + '&lt;/td&gt;';</div><div>                        html += '&lt;td&gt;' + result[i].sex + '&lt;/td&gt;';</div><div>                        html += '&lt;/tr&gt;';</div><div>                    }</div><div><br/></div><div>                    document.querySelector('table').innerHTML = html;</div><ol start="2"><li>使用模板引擎</li></ol><ul><li>模板引擎的作用：将模板内动态加载的部分使用获取来的数据进行替换</li><li>模板引擎的原理：使用相应的正则表达式匹配并获取模板的中的内容，（match[0], match[1]）然后使用replace方法将捕获到的内容进行替换。</li></ul><div>              使用方法：</div><div>               - 编写模板，设置ID</div><div>               - 引入模板引擎，传入模板ID和从后台接收来的数据</div><div>               - 将使用模板引擎获取到的字符串动态渲染到页面中</div><div>                var reslut = JSON.parse(xhr.responseText);</div><div>                    // 数据处理</div><div>                     var data = {</div><div>                         items: reslut</div><div>                     }</div><div><br/></div><div>                     // 调用模板引擎</div><div>                    var html = template('tpl', data);</div><div><br/></div><div>                    console.log(html);</div><div><br/></div><div>                    document.querySelector('table').innerHTML = html;</div><div>               //模板部分</div><div>                 &lt;script type=&quot;text/template&quot; id=&quot;tpl&quot;&gt;</div><div>                        &lt;% for(var i=0; i&lt;items.length; i++) { %&gt;</div><div>                        &lt;tr&gt;</div><div>                             &lt;td&gt;&lt;%= items[i].name %&gt;&lt;/td&gt;</div><div>                             &lt;td&gt;&lt;%= items[i].sex %&gt;&lt;/td&gt;</div><div>                             &lt;td&gt;&lt;%= items[i].ablum %&gt;&lt;/td&gt;</div><div>                             &lt;td&gt;&lt;%= items[i].age %&gt;&lt;/td&gt;</div><div>                        &lt;/tr&gt;</div><div>                       &lt;% } %&gt;</div><div>                 &lt;/script&gt;</div><div><br/></div><div>ajax中使用的浏览器内建对象有：</div><ul><li>XMLHttpRequest:用于在后台向服务器发送数据，实现信息交换</li><li>FormData：用于处理XMLHttpRequest向服务器发送的请求数据（ XMLHttpRequest 2.0中一个新的浏览器内建对象，低版本浏览器不支持），JQuery中还可以使用$('form').serialize()实现序列化表单操作----都是为了打包数据</li></ul><div>JSON和JSONP:</div><ul><li>JSON是用来传递数据的一种轻量级的文本数据交换格式，独立于语言</li><li>JSONP(JSON with Padding)是一种数据调用方式,利用了src标签的课跨域特性，服务器返回的js回调函数中以参数形式包裹着数据，只能以GET方式请求---使用：datatype:'jsonp'即可跨域</li></ul><div><br/></div><div><br/></div></span>
</div></body></html> 